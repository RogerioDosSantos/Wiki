<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="../resources/style.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="python">Python</h1>
<h2 id="additional-information">Additional Information</h2>
<ul>
<li><a href="https://realpython.com">realpython.com</a></li>
</ul>
<h2 id="python---packages">Python - Packages</h2>
<p>The sequence where the <em>Python interpreter</em> search for packages are:</p>
<ul>
<li>The directory from which the input script was run or the current directory if the interpreter is being run interactively</li>
<li>The list of directories contained in the PYTHONPATH environment variable, if it is set. (The format for PYTHONPATH is OS-dependent but should mimic the PATH environment variable.)</li>
<li>An installation-dependent list of directories configured at the time Python is installed</li>
</ul>
<h2 id="commands">Commands</h2>
<p><code>for (name,value) in &lt;class_name&gt;.__dict__.items(): print name,&quot;=&quot;,value</code>: List all properties in a class</p>
<p><code>list=[&quot;val1&quot;, &quot;val2&quot;, ...]</code> : Create a list of items</p>
<p><code>for item in list: print item</code>: Loop over a list</p>
<p><code>dir()</code>: List defined objects</p>
<p><code>dir(&lt;module&gt;)</code>: Define the objects defined in a module</p>
<h2 id="wsgi">WSGI</h2>
<figure>
<img src="http://tinyurl.com/y8q8aj9h" />
</figure>
<p>WSGI is a specification form application interface contract between applications. - WSGI is not a protocol - WSGI is not a implementation, but a specification only.</p>
<p>Below is an example of a <em>Hello World</em> application the implement the <em>WSGI</em> interface.</p>
<figure>
<img src="http://tinyurl.com/yctztv82" />
</figure>
<p>Do not write <em>WSGI</em> application by hand, use a Frameworks e.g.: Flask.</p>
<p>Although the <em>Web Frameworks</em> like <em>Flask or Django</em> provides a development server, they are not enough.</p>
<h2 id="how-to">How-to</h2>
<h3 id="python---function-declaration-and-usage">Python - Function Declaration and usage</h3>
<pre class="python3"><code># Function Declaration
def myfunc( parameter ):
    print &#39;- Paramerer: &#39; % (parameter)
    return

# Function call
myfunc &#39;Test 01&#39;
myfunc &#39;Test 02&#39;</code></pre>
<h3 id="python---web-scrapping-with-beautiful-soup">Python - Web Scrapping with Beautiful Soup</h3>
<p><em>Web Scrapping</em> is the capability to extract information from a <em>Website</em>.</p>
<p>The example below uses <em>Python 3</em> to extract the list of leaders from the site <a href="https://umggaming.com/leaderboards/weekly/activity">umggaming.com</a> using <a href="https://pypi.org/project/beautifulsoup4/">Beautiful Soup</a>.</p>
<p>Note: You can install <em>Beautiful Soup</em> using <code>apt-get install python3-bs4</code></p>
<pre class="python3"><code>import requests
from bs4 import BeautifulSoup

# Get the page
page = requests.get(&#39;https://umggaming.com/leaderboards/weekly/activity&#39;)

# Parse the Page into BeautifulSoup
soup = BeautifulSoup(page.text, &#39;html.parser&#39;)

# Print the desired data
table = soup.find(&#39;table&#39;, {&#39;id&#39;: &#39;leaderboard-table&#39;})
tbody = table.find(&#39;tbody&#39;)
for tr in tbody.findAll(&#39;tr&#39;):
  place = tr.find_all(&#39;td&#39;)[0].text.strip()
  user = tr.find_all(&#39;td&#39;)[1].find_all(&#39;a&#39;)[0].text.strip()
  print(place, user)</code></pre>
<h3 id="python---multi-threading">Python - Multi-Threading</h3>
<pre class="python3"><code>from multiprocessing import Thread
import os
import math

def calc():
    for i in range(0, 70000000):
        math.sqrt(i)

threads = []
for i in range(os.cpu_count()):
    print(&#39;registering thread %d&#39; % i)
    threads.append(Thread(target=calc))

for thread in threads:
    thread.start()

for thread in threads:
    thread.join()</code></pre>
<h3 id="python---multi-processing">Python - Multi-Processing</h3>
<pre class="python3"><code>from multiprocessing import Process
import os
import math

def calc():
    for i in range(0, 70000000):
        math.sqrt(i)

processes = []
for i in range(os.cpu_count()):
    print(&#39;registering process %d&#39; % i)
    processes.append(Process(target=calc))

for process in processes:
    process.start()

for process in processes:
    process.join()</code></pre>
<h3 id="python---call-external-process">Python - Call external process</h3>
<p>Call an external command (as if I'd typed it at the Unix shell or Windows command prompt)</p>
<pre class="python3"><code>import subprocess
import sys

# Sync call - Receive the return code of the execution
subprocess.call([&quot;ls&quot;, &quot;-l&quot;])

# Sync call - Run command with arguments. Wait for command to complete. If the return code was zero then return, otherwise raise CalledProcessErro
try:
    subprocess.check_output([&quot;echo&quot;, &quot;Hello World!&quot;])
except subprocess.CalledProcessError as ex:
    print(&#39;Error!:&#39; + str(ex))

# Async call - You cannot close the current execution
pid = subprocess.Popen([sys.executable, &quot;longtask.py&quot;])

# Async call - You can close the current execution (However the program stay executing until the chield proccess exit)
DETACHED_PROCESS = 0x00000008
pid = subprocess.Popen([sys.executable, &quot;longtask.py&quot;], creationflags=DETACHED_PROCESS).pid

# Async call - You can close the current execution (The chield proccess runs totally independent of the current execution)
CREATE_NEW_CONSOLE = 0x00000010
pid = subprocess.Popen([sys.executable, &quot;longtask.py&quot;], creationflags=CREATE_NEW_CONSOLE).pid</code></pre>
<h3 id="python---file-manipulations">Python - File Manipulations</h3>
<pre class="python3"><code># open/open modes
# r  = open for read (default)
# w  = open for write, truncate
# r+ = open for read/write
# w+ = open for read/write, truncate
# a+ = open for read/append
animals = open(&#39;animals.txt&#39;, &#39;a+&#39;)

# read
text = animals.read()
print text
animals.seek(0)

# read lines
for animal in animals:
    print animal,

# write/append
animals.write(&#39;elephant\n&#39;)
animals.write(&#39;frog\n&#39;)

# close
animals.close()</code></pre>
<h3 id="python---argument-list">Python - Argument list</h3>
<pre class="python3"><code>import argparse
parser = argparse.ArgumentParser()
parser.add_argument(&quot;square&quot;, type=int, help=&quot;display a square of a given number&quot;)
parser.add_argument(&quot;-v&quot;, &quot;--verbosity&quot;, type=int, choices=[0, 1, 2], help=&quot;increase output verbosity&quot;)
args = parser.parse_args()

answer = args.square**2
if args.verbosity == 2:
    print(&quot;the square of {} equals {}&quot;.format(args.square, answer))
elif args.verbosity == 1:
    print(&quot;{}^2 == {}&quot;.format(args.square, answer))
else:
    print(answer)</code></pre>
<pre class="python3"><code>import argparse

parser = argparse.ArgumentParser(description=&#39;Description of your program&#39;)
parser.add_argument(&#39;-f&#39;,&#39;--foo&#39;, help=&#39;Description for foo argument&#39;, required=True)
parser.add_argument(&#39;-b&#39;,&#39;--bar&#39;, help=&#39;Description for bar argument&#39;, required=True)
args = vars(parser.parse_args())

if (args.foo):
    print &#39;foo called!&#39;

if args[&#39;foo&#39;] == &#39;Hello&#39;:
    print &#39;foo called!&#39;

if args[&#39;bar&#39;] == &#39;World&#39;:
    print &#39;bar called!&#39;</code></pre>
<h3 id="python---port-forward">Python - Port forward</h3>
<pre class="python3"><code>import socket
import sys
import thread
import time

def main(setup, error):
    # open file for error messages
    sys.stderr = file(error, &#39;a&#39;)
    # read settings for port forwarding
    for settings in parse(setup):
        thread.start_new_thread(server, settings)
    # wait for &lt;ctrl-c&gt;
    while True:
       time.sleep(60)

def parse(setup):
    settings = list()
    for line in file(setup):
        # skip comment line
        if line.startswith(&#39;#&#39;):
            continue

        parts = line.split()
        settings.append((int(parts[0]), parts[1], int(parts[2])))
    return settings

def server(*settings):
    try:
        dock_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        dock_socket.bind((&#39;&#39;, settings[0]))
        dock_socket.listen(5)
        while True:
            client_socket = dock_socket.accept()[0]
            server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            server_socket.connect((settings[1], settings[2]))
            thread.start_new_thread(forward, (client_socket, server_socket))
            thread.start_new_thread(forward, (server_socket, client_socket))
    finally:
        thread.start_new_thread(server, settings)

def forward(source, destination):
    string = &#39; &#39;
    while string:
        string = source.recv(1024)
        if string:
            destination.sendall(string)
        else:
            source.shutdown(socket.SHUT_RD)
            destination.shutdown(socket.SHUT_WR)

if __name__ == &#39;__main__&#39;:
    main(&#39;port-forward.config&#39;, &#39;error.log&#39;)</code></pre>
<div class="sourceCode"><pre class="sourceCode ini"><code class="sourceCode ini"><span class="dt">80 localhost 8080</span>
<span class="co"># 10020 x.x.x.x 10040</span></code></pre></div>
<h3 id="python---email-fetcher">Python - Email Fetcher</h3>
<pre class="python3"><code># Fetch Emails
# pip install imap-tools
from imap_tools import MailBox
def Fetch_Email(user, pwd):
    mbox = MailBox(&#39;imap.mail.com&#39;).login(user, pwd, &quot;INBOX&quot;)
    for email in mbox.fetch():
        print(email.date, email.subject, len(email.text or email.html))
        
Fetch_Email(&quot;user&quot;, &quot;pass&quot;)</code></pre>
<h3 id="python---analyze-stock-market">Python - Analyze Stock Market</h3>
<pre class="python3"><code># Analyse Stock market
# pip install yfinance
import yfinance as yf
market = yf.Ticker(&quot;MSFT&quot;)
# Get stockmarket info
info = market.info
print(info)
# Fetch historical data
historical = market.history(period=&quot;1y&quot;)
print(historical)
# get actions
actions = market.actions
print(actions)
# get dividends
dividends = market.dividends
print(dividends)
# get splits
splits = market.splits
print(splits)
# get balance sheet
balance_sheet = market.balance_sheet
print(balance_sheet)
# get market news
market_news = market.news
print(market_news)
# show earnings
earnings = market.earnings
print(earnings)
# get recommendation
rec = market.recommendation
print(rec)
# Get another Ticker
market1 = yf.Ticker(&quot;AAPL&quot;)
market2 = yf.Ticker(&quot;TSLA&quot;)
market3 = yf.Ticker(&quot;GOOG&quot;)
# Fetch Market data from multiple tickers
market_data = yf.download(&quot;AAPL&quot;, &quot;GOOG&quot;, start=&quot;2019-01-01&quot;, end=&quot;2019-12-31&quot;)
print(market_data)</code></pre>
<h3 id="python---image-size-compressor">Python - Image Size Compressor</h3>
<pre class="python3"><code># Compress Photo Size
# pip install pyguetzli
import pyguetzli
def Compress(image):
    img = open(image, &quot;rb&quot;).read()
    optimized= pyguetzli.process_jpeg_bytes(img, quality=80)
    output = open(&quot;optimized&quot;, &quot;wb&quot;)
    output.write(optimized)
Compress(&quot;test.jpg&quot;)</code></pre>
<h3 id="python---pysimplegui">Python - PySimpleGui</h3>
<pre class="python3"><code># pip install PySimpleGUI
import PySimpleGUI as gui
layout = []
# Label Text
text = gui.Text(&#39;This is PysimpleGui&#39;, size=(30, 1))
layout.append([text])
# Button
button = gui.Button(&#39;Click Me&#39;, target=&#39;_blank&#39;)
layout.append([button])
# Input Box
input_box = gui.Input(key=&#39;-IN-&#39;)
layout.append([input_box])
# Browse Folders
browse_folder = gui.FolderBrowse()
layout.append([browse_folder])
# Set Image
image = gui.Image(&#39;img.png&#39;)
layout.append([image])
# Radio Buttons
radio = gui.Radio(&#39;Radio&#39;, [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;])
layout.append([radio])
# Check Boxes
check = gui.Checkbox(&#39;Check&#39;, default=True)
layout.append([check])
 
# Set window
win = gui.Window(&#39;Window Title&#39;, layout, auto_size_text=True)
                                                
event, values = win.read()
win.close()</code></pre>
<h3 id="python---merge-csv-files">Python - Merge CSV Files</h3>
<pre class="python3"><code># Merge CSV Files
# pip install pandas
from pandas import read_csv
import pandas
import os
def Merge_Csv(files):
    df = pandas.concat(map(read_csv, files), ignore_index=True)
    df.to_csv(&quot;merged.csv&quot;, index=False)
    print(&quot;CSV has Been Merged...&quot;)
Merge_Csv([&quot;movies.csv&quot;, &quot;movies2.csv&quot;, &quot;movies3.csv&quot;])</code></pre>
<h3 id="python---automate-databases">Python - Automate Databases</h3>
<pre class="python3"><code># Database with Python 
# pip install mysql-connector-python
import mysql.connector
# Connect to yout SQL database
sql = mysql.connector.connect(
    host=&quot;Your host&quot;,
    user=&quot;username&quot;,
    passwd=&quot;&quot;,
    database=&quot;mydatabase_1&quot;
)
# create table
cursor = sql.cursor()
cursor.execute(&quot;CREATE TABLE movies (title VARCHAR(255), rating VARCHAR(255))&quot;)
# insert data
query = &quot;INSERT INTO movies (title, rating) VALUES (%s, %s)&quot;
value = (&quot;The Matrix&quot;, &quot;7.5&quot;)
cursor.execute(query, value)
# Select Data
cursor.execute(&quot;SELECT * FROM movies&quot;)
myresult = cursor.fetchall()
for x in myresult:
    print(x)
    
# Delete Data
cursor.execute(&quot;DELETE FROM movies WHERE title = &#39;The Matrix&#39;&quot;)
# Get Specific Data
cursor.execute(&quot;SELECT * FROM movies WHERE title = &#39;The Matrix&#39;&quot;)
myresult = cursor.fetchall()
# Update Data
cursor.execute(&quot;UPDATE movies SET rating = &#39;8&#39; WHERE title = &#39;The Matrix&#39;&quot;)
# Delete Table
cursor.execute(&quot;DROP TABLE movies&quot;)
# Close Connection
sql.close()</code></pre>
<h3 id="python---classes">Python - Classes</h3>
<h4 id="definition">Definition</h4>
<pre class="python3"><code>class Dog:

    def __init__(self, name):
        self.name = name
        self.tricks = []    # creates a new empty list for each dog

    def add_trick(self, trick):
        self.tricks.append(trick)</code></pre>
<h4 id="usage">Usage</h4>
<pre class="python3"><code>d = Dog(&#39;Fido&#39;)
e = Dog(&#39;Buddy&#39;)
d.add_trick(&#39;roll over&#39;)
e.add_trick(&#39;play dead&#39;)
d.tricks
e.tricks</code></pre>
<h3 id="python---logging">Python - Logging</h3>
<h4 id="global-logging">Global Logging</h4>
<pre class="python3"><code>import logging

# Log Messages
logging.debug(&#39;This is a debug message&#39;)
logging.info(&#39;This is an info message&#39;)
logging.warning(&#39;This is a warning message&#39;)
logging.error(&#39;This is an error message&#39;)
logging.critical(&#39;This is a critical message&#39;)

name = &#39;Roger&#39;
logging.error(&#39;%s raised an error&#39;, name)
logging.error(f&#39;{name} raised an error&#39;)

# Log Config

## Allow Log all levels
### E.g.: DEBUG:root:This will get logged
logging.basicConfig(level=logging.DEBUG)

## Allow log to file changing the log print format
### E.g.: root - ERROR - This will get logged to a file
logging.basicConfig(filename=&#39;app.log&#39;, filemode=&#39;w&#39;, format=&#39;%(name)s - %(levelname)s - %(message)s&#39;)

## Output Formats

### E.g.: 18472-WARNING-This is a Warning
logging.basicConfig(format=&#39;%(process)d-%(levelname)s-%(message)s&#39;)

### E.g.: 2018-07-11 20:12:06,288 - Admin logged in
logging.basicConfig(format=&#39;%(asctime)s - %(message)s&#39;, level=logging.INFO)

### E.g.: 12-Jul-18 20:53:19 - Admin logged out
logging.basicConfig(format=&#39;%(asctime)s - %(message)s&#39;, datefmt=&#39;%d-%b-%y %H:%M:%S&#39;)

# Stack Trace
a = 5
b = 0

try:
  c = a / b
except Exception as e:
  logging.error(&quot;Exception occurred&quot;, exc_info=True)

try:
  c = a / b
except Exception as e:
  logging.exception(&quot;Exception occurred&quot;)
</code></pre>
<h4 id="logger-object">Logger Object</h4>
<pre class="python3"><code># logging_example.py

import logging

# Create a custom logger
logger = logging.getLogger(__name__)

# Create handlers
c_handler = logging.StreamHandler()
f_handler = logging.FileHandler(&#39;file.log&#39;)
c_handler.setLevel(logging.WARNING)
f_handler.setLevel(logging.ERROR)

# Create formatters and add it to handlers
c_format = logging.Formatter(&#39;%(name)s - %(levelname)s - %(message)s&#39;)
f_format = logging.Formatter(&#39;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#39;)
c_handler.setFormatter(c_format)
f_handler.setFormatter(f_format)

# Add handlers to the logger
logger.addHandler(c_handler)
logger.addHandler(f_handler)

logger.warning(&#39;This is a warning&#39;)
logger.error(&#39;This is an error&#39;)</code></pre>
<h3 id="python---looping">Python - Looping</h3>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># Loop until Ctrl-C is pressed</span>
<span class="cf">try</span>:
    <span class="cf">while</span> <span class="va">True</span>:
       <span class="bu">print</span>(<span class="st">&#39;Press Ctrl-C to stop&#39;</span>)
       time.sleep(<span class="fl">0.5</span>)
<span class="cf">except</span> <span class="pp">KeyboardInterrupt</span>:
    <span class="cf">pass</span></code></pre></div>
<h3 id="python---download-file-from-url">Python - Download file from URL</h3>
<p>Download file and save in disk (Temp folder)</p>
<pre class="python3"><code>import urllib
urllib.urlretrieve (&quot;http://www.example.com/songs/mp3.mp3&quot;, &quot;/tmp/mp3.mp3&quot;)</code></pre>
<p>Download file and display a progress bar</p>
<pre class="python3"><code>import urllib2

url = &quot;http://download.thinkbroadband.com/10MB.zip&quot;

file_name = url.split(&#39;/&#39;)[-1]
u = urllib2.urlopen(url)
f = open(file_name, &#39;wb&#39;)
meta = u.info()
file_size = int(meta.getheaders(&quot;Content-Length&quot;)[0])
print &quot;Downloading: %s Bytes: %s&quot; % (file_name, file_size)

file_size_dl = 0
block_sz = 8192
while True:
    buffer = u.read(block_sz)
    if not buffer:
        break

    file_size_dl += len(buffer)
    f.write(buffer)
    status = r&quot;%10d  [%3.2f%%]&quot; % (file_size_dl, file_size_dl * 100. / file_size)
    status = status + chr(8)*(len(status)+1)
    print status,

f.close()</code></pre>
<h3 id="python---creating-temporary-files-and-directories">Python - Creating temporary files and directories</h3>
<pre class="python3"><code>import tempfile

# create a temporary file and write some data to it
fp = tempfile.TemporaryFile()
fp.write(b&#39;Hello world!&#39;)
# read data from file
fp.seek(0)
fp.read()
b&#39;Hello world!&#39;
# close the file, it will be removed
fp.close()

# create a temporary file using a context manager
with tempfile.TemporaryFile() as fp:
  fp.write(b&#39;Hello world!&#39;)
  fp.seek(0)
  fp.read()
b&#39;Hello world!&#39;

# file is now closed and removed

# create a temporary directory using the context manager
with tempfile.TemporaryDirectory() as tmpdirname:
  print(&#39;created temporary directory&#39;, tmpdirname)

# directory and contents have been removed</code></pre>
<h3 id="python---directories-and-files">Python - Directories and Files</h3>
<h4 id="remove-folder-if-exists">Remove folder if exists</h4>
<pre class="python3"><code>import shutil

dir = &#39;path_to_my_folder&#39;
if os.path.exists(dir):
    shutil.rmtree(dir)
os.makedirs(dir)</code></pre>
<h4 id="copy-folder-recursively">Copy folder recursively</h4>
<pre class="python3"><code>from shutil import copytree, ignore_patterns

# Every File
copytree(source, destination, ignore=ignore_patterns(&#39;*.pyc&#39;, &#39;tmp*&#39;))

# Ignoring some files
copytree(source, destination, ignore=ignore_patterns(&#39;*.pyc&#39;, &#39;tmp*&#39;))</code></pre>
<h4 id="compressing-uncompressing-folder-zip">Compressing / Uncompressing Folder (Zip)</h4>
<pre class="python3"><code># Compress folder - When uncompressed it will not keep the example
shutil.make_archive(&#39;/home/test/example&#39;, &#39;zip&#39;, &#39;/home/test/example&#39;)

# Compress folder - When uncompressed it will keep the example
shutil.make_archive(&#39;/home/test/example&#39;, &#39;zip&#39;, &#39;/home/test/&#39;, &#39;example&#39;)

# Uncompress folder
shutil.unpack_archive(&quot;example.zip&quot;, extract_dir=&quot;/tmp&quot;)</code></pre>
<h3 id="python---tinydb">Python - TinyDB</h3>
<h4 id="installation">Installation</h4>
<pre class="python3"><code>pip install tinydb</code></pre>
<h4 id="usage-1">Usage</h4>
<pre class="python3"><code>from tinydb import TinyDB, Query

# Open database
db = TinyDB(&#39;db.json&#39;)

# Open database in memory
from tinydb.storages import MemoryStorage
db = TinyDB(storage=MemoryStorage)

# Insert Data
db.insert({&#39;type&#39;: &#39;OSFY&#39;, &#39;count&#39;: 700})
db.insert({&#39;type&#39;: &#39;EFY&#39;, &#39;count&#39;: 800})

# Get all data
db.all()

# Search Data
Magazine = Query()
db.search(Magazine.type == &#39;OSFY&#39;)
db.search(Magazine.count &gt; 750)

# Update Data
db.update({&#39;count&#39;: 1000}, Magazine.type == &#39;OSFY&#39;)

# Remove Data
db.remove(Magazine.count &lt; 900)

# Remove all 
db.purge()</code></pre>
<h3 id="python---webproxy">Python - WebProxy</h3>
<pre class="python3"><code>from mitmproxy import http

def request(flow: http.HTTPFlow):
    # redirect to different host
    if flow.request.pretty_host == &quot;example.com&quot;:
        flow.request.host = &quot;mitmproxy.org&quot;
    # answer from proxy
    elif flow.request.path.endswith(&quot;/brew&quot;):
        flow.response = http.HTTPResponse.make(
            418, b&quot;I&#39;m a teapot&quot;,
        )</code></pre>
<h3 id="python---exceptions">Python - Exceptions</h3>
<pre class="python3"><code>try:
  raise ValueError(&#39;A very specific bad thing happened.&#39;)
except Exception as e:
  print(&#39;Exception desc: {e}&#39;.format(e=str(e)))
finally:
  print(&#39;Enter here no matter what&#39;)</code></pre>
<h3 id="python---decorated-static-vars">Python - Decorated Static Vars</h3>
<pre class="python3"><code>def static_vars(**kwargs):
    def decorate(func):
        for k in kwargs:
            setattr(func, k, kwargs[k])
        return func
    return decorate</code></pre>
<h3 id="python---thread-lock">Python - Thread Lock</h3>
<pre class="python3"><code>import time
import threading
import atexit
from apscheduler.schedulers.background import BackgroundScheduler

lock = threading.Lock()
scheduler = BackgroundScheduler()

def protected_function():
  print(&#39;Several threads call this&#39;)
  if lock.locked():
    return True
  with lock:
    print(&#39;Only 1 thread call this per time&#39;)
    time.sleep(10)

def run():
  job_defaults = {
    &#39;coalesce&#39;: False,
    &#39;max_instances&#39;: 3
  }
  scheduler.add_job(func=execution_loop, trigger=&quot;interval&quot;, job_defaults=job_defaults, seconds=1)
  scheduler.start()
  print(&#39;Press Ctrl-C to stop the execution&#39;)
  atexit.register(lambda: shutdown())
  try:
    while True:
      time.sleep(1)
  except KeyboardInterrupt:
    pass

def shutdown():
  scheduler.shutdown()

if __name__ == &#39;__main__&#39;:
    run()</code></pre>
<h3 id="python-packages---create-requirements-file">Python Packages - Create Requirements File</h3>
<p><a href="https://pip.pypa.io/en/stable/user_guide/#requirements-files">Requirements files</a> are files containing a list of items to be installed using <a href="https://pip.pypa.io/en/stable/reference/pip_install/#pip-install">pip install</a></p>
<pre class="shell"><code># Create Requirements Files
pip freeze &gt; requirements.txt

# Install using requirements-files
pip install -r requirements.txt</code></pre>
<h3 id="python---get-debug-information">Python - Get debug information</h3>
<pre class="python3"><code># Print all variables from a functions
print(locals())</code></pre>
<h3 id="python---execute-python-to-get-info-of-a-package">Python - Execute python to get info of a package</h3>
<pre class="shell"><code># Find python location
python -c &quot;import sys; print(sys.executable)&quot;

# Find specific package version
python -c &quot;import package_name; print(package_name.__version__)&quot;

# Find specific package location
python -c &quot;import package_name; print(package_name.__file__)&quot;</code></pre>
<h3 id="python---photo-editing">Python - Photo Editing</h3>
<pre class="python3"><code># Photo Editing 
# pip install pillow
from PIL import Image, ImageFilter
# Resize an image
img = Image.open(&#39;img.jpg&#39;)
resize = img.resize((200, 300))
resize.save(&#39;output.jpg&#39;)
# Blur Image
img = Image.open(&#39;img.jpg&#39;)
blur = img.filter(ImageFilter.BLUR)
blur.save(&#39;output.jpg&#39;)
# Sharp Image
img = Image.open(&#39;img.jpg&#39;)
sharp = img.filter(ImageFilter.SHARPEN)
sharp.save(&#39;output.jpg&#39;)
# Crop Image
img = Image.open(&#39;img.jpg&#39;)
crop = img.crop((0, 0, 50, 50))
crop.save(&#39;output.jpg&#39;)
# Rotate Image
img = Image.open(&#39;img.jpg&#39;)
rotate = img.rotate(90)
rotate.save(&#39;output.jpg&#39;)
# Flip Image
img = Image.open(&#39;img.jpg&#39;)
flip = img.transpose(Image.FLIP_LEFT_RIGHT)
flip.save(&#39;output.jpg&#39;)
# Transpose Image
img = Image.open(&#39;img.jpg&#39;)
transpose = img.transpose(Image.TRANSPOSE)
transpose.save(&#39;output.jpg&#39;)
# Convert Image to GreyScale
img = Image.open(&#39;img.jpg&#39;)
convert = img.convert(&#39;L&#39;)
convert.save(&#39;output.jpg&#39;)</code></pre>
<h3 id="python---read-excel">Python - Read Excel</h3>
<pre class="python3"><code># Read Excel
# pip install pandas
import pandas as pd
df = pd.read_excel(&#39;test.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
# Read Columns
name = df[&#39;Name&#39;].to_list()
Id  = df[&#39;Id&#39;].to_list()
print(name) # [&quot;haider&quot;, &quot;Dustin, &quot;Tadashi&quot;]
print(Id) # [245, 552, 892]</code></pre>
<h3 id="python---automate-win-mac-and-linux">Python - Automate Win, Mac and Linux</h3>
<pre class="python3"><code># Automate Win, Mac and Linux
# pip install PyAutoGUI
import pyautogui as py
# Mouse Movements
py.moveTo(100, 100)
py.moveTo(200, 200, duration=1)
py.click(100, 100)
py.doubleClick(200, 200)
# Keyboard Inputs
py.write(&#39;Hello World!&#39;, interval=0.25)
py.press(&#39;enter&#39;)
py.hotkey(&#39;ctrl&#39;, &#39;c&#39;)
py.keyDown(&#39;shift&#39;)
py.keyUp(&#39;shift&#39;)
# Screen Automation
img = py.screenshot(&#39;screenshot.jpg&#39;)
img.save(&#39;screenshot.jpg&#39;)
loc = py.locationsOnScreen(&#39;icon.jpg&#39;)
print(loc)</code></pre>
<h3 id="python---grammar-checker">Python - Grammar Checker</h3>
<pre class="python3"><code># Grammar Checker in Python
# pip install gingerit
from gingerit.gingerit import GingerIt
text = &quot;Welcm Progammer to Python&quot;
Grammer = GingerIt()
Correction = Grammer.parse(text)
print(Correction[&quot;result&quot;]) # Welcome, Programmer to Python
print(Correction[&#39;corrections&#39;])</code></pre>
<h3 id="python---spell-checker">Python - Spell Checker</h3>
<pre class="python3"><code># Spell Checker in Python 
# pip install pyspellchecker
from spellchecker import SpellChecker as spell
Words = spell.unknown([&#39;Python&#39;  , &#39;is&#39; , &#39;a&#39; , &#39;good&#39; , &#39;lantyguage&#39;])
for w in Words:
    print(spell.correction(w)) #language
    print(spell.candidates(w)) #{ language }</code></pre>
<h3 id="python---gui-window">Python - GUI (Window)</h3>
<pre class="python3"><code># Python GUI
# pip install PyQt6
import sys
from PyQt6.QtWidgets import QApplication, QWidget, QPushButton, QMessageBox, QLabel, QLineEdit
def Application():
app = QApplication(sys.argv)
    win = QWidget()
    win.resize(300, 300)
    win.move(200, 200)
    win.setWindowTitle(&#39;Medium Article&#39;)
# Create Buttons
    btn = QPushButton(&#39;Quit&#39;, win)
    
    # Message Box
    QMessageBox.question(win, &#39;Message&#39;,&quot;Are you sure to quit?&quot;)
# Label Text
    lbl = QLabel(&#39;Hello World&#39;, win)
# Button Clicked
    btn.clicked.connect(lambda: QMessageBox.question(win, &#39;Message&#39;,&quot;Are you sure to quit?&quot;))
# Entry Box
    entry = QLineEdit(win)
win.show()
    sys.exit(app.exec())
if __name__ == &#39;__main__&#39;:
    Application()</code></pre>
<h3 id="python---http-client">Python - HTTP Client</h3>
<pre class="python3"><code># Request Api 
# pip install requests
import requests
# Get Data
headers = {
    &quot;Connection&quot;: &quot;keep-alive&quot;,
    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36&quot;
}
r = requests.get(&#39;https://api.example.com&#39;, headers=headers)
print(r.status_code) # 200
print(r.headers[&#39;content-type&#39;])
print(r.content) # HTML Data
# Login Site
payload = {&#39;username&#39;: &#39;USERNAME&#39;, &#39;userpass&#39;: &#39;PASSWORD&#39;}
r = requests.post(&#39;https://example.com/login&#39;, data=payload)
print(r.status_code) # 200</code></pre>
<h3 id="python---ai-convert-speech-to-text">Python - AI Convert Speech to Text</h3>
<pre class="python3"><code># Convert Speech to Text
#pip install SpeechRecognition
import speech_recognition as sr
def SpeechToText():
Ai = sr.Recognizer()
    with sr.Microphone() as source:
        listening = Ai.listen(source, phrase_time_limit = 6)  
    try:
        command = Ai.recognize_google(listening).lower()
        print(&quot;You said: &quot; + command)
        
    except sr.UnknownValueError:
        print(&quot;Sorry Can&#39;t understand, Try again&quot;)
        SpeechToText()</code></pre>
<h3 id="python---video-editing">Python - Video Editing</h3>
<pre class="python3"><code># Video Editing
# pip install moviepy
from moviepy.editor import *
# Triming the video
clip_1 = VideoFileClip(&quot;sample_video.mp4&quot;).subclip(40, 50)
clip_2 = VideoFileClip(&quot;sample_video.mp4&quot;).subclip(68, 91)
final_clip = concatenate_videoclips([clip_1, clip_2])
final_clip.write_videofile(&quot;output.mp4&quot;)
# Adding VFX
clip_1 = (VideoFileClip(&quot;sample_video.mp4&quot;).subclip(40, 50).fx(vfx.colorx, 1.2).fx(vfx.lum_contrast, 0, 30, 100))
clip_2 = (VideoFileClip(&quot;sample_video.mp4&quot;).subclip(68, 91).fx(vfx.invert_colors))
final_clip = concatenate_videoclips([clip_1, clip_2])
final_clip.write_videofile(&quot;output.mp4&quot;)
# Add Audio to Video
clip = VideoFileClip(&quot;sample_video.mp4&quot;)
# Add audio to only first 5 sec
clip = clip.subclip(0, 5)
audioclip = AudioFileClip(&quot;audio.mp3&quot;).subclip(0, 5)
videoclip = clip.set_audio(audioclip)
final_clip.write_videofile(&quot;output.mp4&quot;)
</code></pre>
<h3 id="python---watermark-pdf-files">Python - Watermark PDF files</h3>
<pre class="python3"><code># Watermark PDF files
# pip install PyPDF4
import PyPDF4
def Watermark():
    pdf_file= &quot;test.pdf&quot;
    output_pdf= &quot;output.pdf&quot;
    watermark= &quot;watermark.pdf&quot;
watermark_read = PyPDF4.PdfFileReader(watermark)
    watermark_page = watermark_read.getPage(0)
    pdf_reader = PyPDF4.PdfFileReader(pdf_file)
    pdf_writer = PyPDF4.PdfFileWriter()
    for page in range(pdf_reader.getNumPages()):
page = pdf_reader.getPage(page)
        page.mergePage(watermark_page)
        pdf_writer.addPage(page)
    
    # writing output pdf file
    with open(output_pdf, &#39;wb&#39;) as pdf:
        pdf_writer.write(pdf)
Watermark()</code></pre>
<h3 id="remove-background-from-image">Remove background from image</h3>
<pre class="python3"><code># Get Your API: https://www.remove.bg/tools-api
# pip install remove-bg-api
from remove_bg_api import RemoveBg
# Remove from File
bg = RemoveBg(&quot;Your API&quot;)  
img = bg.remove_bg_file(input_path=&quot;img.jpg&quot;, out_path=&quot;out.jpg&quot;)
# Remove from URL
img_url = &quot;https://www.example.com/img&quot;
img = bg.remove_background_from_img_url(input_url=img_url, out_path=&quot;out.jpg&quot;)</code></pre>
<h3 id="url-shortener">URL Shortener</h3>
<pre class="python3"><code># Get your API: https://dev.bitly.com/
# pip install bitly_api
import bitly_api
api_key = &quot;&quot;
req = bitly_api.Connection(api_key)
url = &quot;https://medium.com/&quot;
# Get the short url
short_url = req.shorten(url)
print(short_url)</code></pre>
<h3 id="calls-and-sms">Calls and SMS</h3>
<pre class="python3"><code># Get your API
# pip install twilio
import twilio.rest
acc = &quot;API Key&quot;
token = &quot;API Token&quot;
cli = twilio.rest.Client(acc, token)
# Send SMS
msg = cli.messages.create(to=&quot;+xxxxxxxxxx&quot;, from_=&quot;+xxxxxxxxxx&quot;, body=&quot;Medium&quot;)
# Do Programatic Calls
cli.calls.create(to=&quot;+xxxxxxxxxx&quot;, from_=&quot;+xxxxxxxxxx&quot;, twiml=&#39;&lt;Response&gt;&lt;Say&gt; Medium &lt;/Say&gt;&lt;/Response&gt;&#39;,)</code></pre>
<h3 id="fix-grammeraticall-errors">Fix Grammeraticall Errors</h3>
<pre class="python3"><code># pip install gingerit
import gingerit.gingerit as grammer
txt = &quot;I&#39;m a Pogrammer, and I live to code&quot;
fix = grammer.GingerIt()
correction = fix.parse(txt)
print(&quot;Original: &quot; + data)
print(&quot;Corrected: &quot; + correction[&quot;result&quot;])
print(&quot;corrections: &quot; + str(correction[&quot;corrections&quot;]))</code></pre>
<h3 id="compress-files">Compress Files</h3>
<pre class="python3"><code>import zipfile as ziplib                                    
# Compress large file
def Compress_large_file(filename):
    # zip with compression level 9
    with ziplib.ZipFile(filename, &#39;w&#39;, ziplib.ZIP_DEFLATED) as zf:
        zf.write(filename)
    
# Decompress large file
def Decompress_large_file(filename):
    with ziplib.ZipFile(filename, &#39;r&#39;) as z:
        z.extractall()</code></pre>
<h3 id="create-bacodes">Create Bacodes</h3>
<pre class="python3"><code># pip install python-barcode
import barcode as code
from barcode.writer import ImageWriter
# Get all formats
print(code.PROVIDED_BARCODES)
number = &quot;0123401234567&quot;
bar_format = code.get_barcode_class(&quot;EAN13&quot;)
barcode = bar_format(number, writer=ImageWriter())
barcode.save(&quot;barcode.png&quot;)</code></pre>
<h3 id="random-password-generator">Random Password Generator</h3>
<pre class="python3"><code>import random
import string
def random_password(length):
    password = &#39;&#39;
    char =  string.ascii_letters
    for i in range(length):
        password += random.choice(char + string.digits)
    return password
print(random_password(10))
print(random_password(7))</code></pre>
</body>
</html>
